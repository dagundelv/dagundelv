var _createClass=function(){function c(b,a){for(var d=0;d<a.length;d++){var c=a[d];c.enumerable=c.enumerable||!1;c.configurable=!0;"value"in c&&(c.writable=!0);Object.defineProperty(b,c.key,c)}}return function(b,a,d){a&&c(b.prototype,a);d&&c(b,d);return b}}();function _toConsumableArray(c){if(Array.isArray(c)){for(var b=0,a=Array(c.length);b<c.length;b++)a[b]=c[b];return a}return Array.from(c)}
function _classCallCheck(c,b){if(!(c instanceof b))throw new TypeError("Cannot call a class as a function");}function _possibleConstructorReturn(c,b){if(!c)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!b||"object"!==typeof b&&"function"!==typeof b?c:b}
function _inherits(c,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);c.prototype=Object.create(b&&b.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}});b&&(Object.setPrototypeOf?Object.setPrototypeOf(c,b):c.__proto__=b)}
var Bar=function(c){function b(){_classCallCheck(this,b);return _possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}_inherits(b,c);_createClass(b,[{key:"render",value:function(){return React.createElement("div",{className:"bar",style:{background:"rgb("+(0>=this.props.milliseconds?0:Math.floor(this.props.milliseconds/this.props.maxMilliseconds*200))+","+(0>=this.props.milliseconds?255:Math.floor(255-this.props.milliseconds/this.props.maxMilliseconds*128))+
",0)",width:(0>=this.props.milliseconds?0:Math.floor(this.props.milliseconds/this.props.maxMilliseconds*200))+"px"}})}}]);return b}(React.Component),Milliseconds=function(c){function b(){_classCallCheck(this,b);return _possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}_inherits(b,c);_createClass(b,[{key:"render",value:function(){return React.createElement("span",{className:"milliseconds"},0==this.props.milliseconds?"...":0>this.props.milliseconds?-this.props.milliseconds+
"/5":this.props.milliseconds+"ms")}}]);return b}(React.Component),Tip=function(c){function b(){_classCallCheck(this,b);return _possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}_inherits(b,c);_createClass(b,[{key:"render",value:function(){return React.createElement("span",{className:"tip"},this.props.downloadText)}}]);return b}(React.Component),Name=function(c){function b(a){_classCallCheck(this,b);a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,
a));a.handleClick=a.handleClick.bind(a);return a}_inherits(b,c);_createClass(b,[{key:"handleClick",value:function(){var a=this.props.url,b=a.indexOf("://")+3,c=a.indexOf("/",b);a=a.substring(b,c);this.props.showNotice(this.props.provider,this.props.locationName,a,this.props.download)}},{key:"render",value:function(){return React.createElement("span",{className:"name",onClick:this.handleClick,style:{cursor:void 0==this.props.download?"help":"pointer"}},this.props.locationName,React.createElement(Tip,
{className:"tip",downloadText:void 0==this.props.download?"Show Server":"Server&Download"}))}}]);return b}(React.Component),Line=function(c){function b(){_classCallCheck(this,b);return _possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).apply(this,arguments))}_inherits(b,c);_createClass(b,[{key:"render",value:function(){return React.createElement("div",{className:"line",style:{transform:"translateY("+20*this.props.index+"px)",zIndex:this.props.number-this.props.index+1}},React.createElement(Milliseconds,
{milliseconds:this.props.milliseconds}),React.createElement(Name,{locationName:this.props.name,download:this.props.download,provider:this.props.provider,url:this.props.url,showNotice:this.props.showNotice}),React.createElement(Bar,{milliseconds:this.props.milliseconds,maxMilliseconds:this.props.maxMilliseconds}))}}]);return b}(React.Component),List=function(c){function b(a){_classCallCheck(this,b);a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));a.state={millisecondsOfTargets:[],
rankList:[]};a.data={img:document.createElement("img"),testTimeOut:!1,timeOutId:null,currentIndex:0,countOfLoad:0,startTime:0,endTime:0,minOfCurrentTarget:6E4};document.body.appendChild(a.data.img);a.lineRef=[];for(var c=0;c<=Object.keys(a.props.targets).length-1;c++)a.lineRef[c]=React.createRef();for(c=0;c<=Object.keys(a.props.targets).length-1;c++)a.state.millisecondsOfTargets[c]=0;for(c=0;c<=Object.keys(a.props.targets).length-1;c++)a.state.rankList[c]={id:c,rank:c,milliseconds:6E4+c};a.onTimeOut=
a.onTimeOut.bind(a);a.onLoaded=a.onLoaded.bind(a);return a}_inherits(b,c);_createClass(b,[{key:"updateCount",value:function(){var a=this.state.millisecondsOfTargets.slice();a[this.data.currentIndex]=-this.data.countOfLoad;this.setState({millisecondsOfTargets:a})}},{key:"onTimeOut",value:function(){var a=this.data.img.onerror;this.data.img.onerror=null;this.data.img.src="";setTimeout(a,1)}},{key:"clearThisTimeOut",value:function(){try{clearTimeout(this.data.timeOutId)}catch(a){console.log("clearThisTimeOut ERROR")}}},
{key:"prepareTimeOut",value:function(){this.clearThisTimeOut();this.data.timeOutId=setTimeout(this.onTimeOut,6E3)}},{key:"doNextTest",value:function(){var a=this.lineRef[this.data.currentIndex];this.data.countOfLoad++;this.updateCount();this.data.startTime=(new Date).getTime();this.data.img.onerror=this.onLoaded;this.prepareTimeOut();this.data.testTimeOut||(this.data.img.src=a.current.props.url+Math.random())}},{key:"doNextTarget",value:function(){this.data.currentIndex++;if(this.data.currentIndex>
this.lineRef.length-1)this.props.providerFinished(),this.clearThisTimeOut();else{var a=this.lineRef[this.data.currentIndex];this.data.countOfLoad=1;this.updateCount();this.data.startTime=(new Date).getTime();this.data.img.onerror=this.onLoaded;this.prepareTimeOut();this.data.testTimeOut||(this.data.img.src=a.current.props.url+Math.random())}}},{key:"onLoaded",value:function(){if(1==this.data.countOfLoad)this.doNextTest();else{this.data.endTime=(new Date).getTime();var a=this.data.endTime-this.data.startTime;
a<this.data.minOfCurrentTarget&&(this.data.minOfCurrentTarget=a);if(5==this.data.countOfLoad){a=this.state.millisecondsOfTargets.slice();a[this.data.currentIndex]=this.data.minOfCurrentTarget;this.setState({millisecondsOfTargets:a});var b=JSON.parse(JSON.stringify(this.state.rankList));b[this.data.currentIndex].milliseconds=this.data.minOfCurrentTarget;a=JSON.parse(JSON.stringify(b));a.sort(function(a,b){return a.milliseconds-b.milliseconds});b=JSON.parse(JSON.stringify(b));for(var c=0;c<=b.length-
1;c++)for(var f=b[c].id,e=0;e<=a.length;e++)if(f==a[e].id){b[c].rank=e;break}this.setState({rankList:b});this.data.minOfCurrentTarget=6E4;this.doNextTarget()}else this.doNextTest()}}},{key:"componentDidMount",value:function(){var a=this.lineRef[this.data.currentIndex];this.data.countOfLoad=1;this.updateCount();this.data.startTime=(new Date).getTime();this.data.img.onerror=this.onLoaded;this.prepareTimeOut();this.data.testTimeOut||(this.data.img.src=a.current.props.url+Math.random())}},{key:"render",
value:function(){return React.createElement("div",{className:"list"},this.props.targets.map(function(a,b){return React.createElement(Line,{name:a.name,key:b,url:a.url,download:a.download,milliseconds:this.state.millisecondsOfTargets[b],maxMilliseconds:Math.max.apply(Math,_toConsumableArray(this.state.millisecondsOfTargets)),index:this.state.rankList[b].rank,number:this.state.rankList.length,provider:this.props.provider,showNotice:this.props.showNotice,ref:this.lineRef[b]})}.bind(this)))}}]);return b}(React.Component),
Message=function(c){function b(a){_classCallCheck(this,b);a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));a.reload=a.reload.bind(a);return a}_inherits(b,c);_createClass(b,[{key:"reload",value:function(){location.reload()}},{key:"render",value:function(){return React.createElement("div",{className:"message",style:{visibility:this.props.messageVisible?"visible":"hidden"}},"During download, ping might not be precise.",React.createElement("br",null),React.createElement("br",
null),React.createElement("div",{style:{textAlign:"center"}},React.createElement("a",{className:"larger",href:"javascript:void(0);",onClick:this.reload},"Reload"),React.createElement("span",null,"\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0"),React.createElement("a",{className:"larger",href:"javascript:void(0);",onClick:this.props.hideMessage},"Close")))}}]);return b}(React.Component),Notice=function(c){function b(a){_classCallCheck(this,b);a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,
a));a.handleClick=a.handleClick.bind(a);return a}_inherits(b,c);_createClass(b,[{key:"handleClick",value:function(){void 0!=this.props.clickedDownload&&(this.props.allProvidersFinished()||this.props.showMessage(),window.open(this.props.clickedDownload,"_blank"))}},{key:"render",value:function(){return React.createElement("div",{className:"notice",style:{visibility:this.props.noticeVisible?"visible":"hidden"}},React.createElement("span",{className:"bold"},this.props.clickedProvider),React.createElement("br",
null),this.props.clickedName," ",React.createElement("br",null),React.createElement("a",{className:"larger",href:"javascript:void(0)",onClick:this.handleClick},void 0==this.props.clickedDownload?"No Download":"Test Download"),React.createElement("br",null),React.createElement("br",null),React.createElement("textarea",{className:"server",readOnly:!0,value:this.props.clickedServer}),React.createElement("div",null,React.createElement("span",{style:{fontStyle:"italic"}},"Copy server address",React.createElement("br",
null),"for further testing"),React.createElement("br",null),React.createElement("br",null),React.createElement("a",{className:"larger",href:"javascript:void(0);",onClick:this.props.hideNotice},"Close")))}}]);return b}(React.Component),App=function(c){function b(a){_classCallCheck(this,b);a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this,a));a.state={allData:data,messageVisible:!1,noticeVisible:!1,clickedProvider:"",clickedName:"",clickedServer:"",clickedDownload:""};
a.data={countOfFinishedProviders:0};a.providerFinished=a.providerFinished.bind(a);a.allProvidersFinished=a.allProvidersFinished.bind(a);a.showMessage=a.showMessage.bind(a);a.hideMessage=a.hideMessage.bind(a);a.showNotice=a.showNotice.bind(a);a.hideNotice=a.hideNotice.bind(a);return a}_inherits(b,c);_createClass(b,[{key:"providerFinished",value:function(){this.data.countOfFinishedProviders++}},{key:"allProvidersFinished",value:function(){return this.data.countOfFinishedProviders==Object.keys(this.state.allData).length}},
{key:"showMessage",value:function(){this.setState({messageVisible:!0})}},{key:"hideMessage",value:function(){this.setState({messageVisible:!1})}},{key:"showNotice",value:function(a,b,c,f){this.setState({clickedProvider:a,clickedName:b,clickedServer:c,clickedDownload:f,noticeVisible:!0});setTimeout(function(){for(var a=document.getElementsByClassName("server"),b=0;b<=a.length-1;b++)a[b].select()},500)}},{key:"hideNotice",value:function(){this.setState({noticeVisible:!1})}},{key:"render",value:function(){return React.createElement("div",
null,React.createElement(Message,{messageVisible:this.state.messageVisible,hideMessage:this.hideMessage}),React.createElement(Notice,{noticeVisible:this.state.noticeVisible,hideNotice:this.hideNotice,allProvidersFinished:this.allProvidersFinished,showMessage:this.showMessage,clickedProvider:this.state.clickedProvider,clickedName:this.state.clickedName,clickedServer:this.state.clickedServer,clickedDownload:this.state.clickedDownload}),Object.keys(this.state.allData).map(function(a,b){return React.createElement("div",
{className:"section",key:b,style:{height:20*this.state.allData[a].length+30+"px"}},React.createElement("h3",null,a),React.createElement(List,{provider:a,providerFinished:this.providerFinished,showNotice:this.showNotice,targets:this.state.allData[a]}))}.bind(this)))}}]);return b}(React.Component);function main(){ReactDOM.render(React.createElement(App,null),document.getElementById("result"))};